<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù„ÛŒØ³Øª Ú©Ø§Ø±Ù‡Ø§ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ ğŸŒŸ</title>
<style>
:root {
  --accent: #ff5b93;
  --bg: #fff8fb;
  --card: #fff;
  --text: #222;
  --shadow: rgba(0,0,0,0.12);
}
* { box-sizing: border-box; margin:0; padding:0; }
body { font-family: Tahoma, sans-serif; background: var(--bg); color: var(--text); padding: 16px; }
h1 { color: var(--accent); margin-bottom: 16px; }
.container { max-width: 800px; margin: auto; }
.controls { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 16px; }
input, select { padding: 8px; border-radius: 8px; border: 1px solid #ddd; flex:1; }
button { padding: 8px 12px; border:none; border-radius:8px; cursor:pointer; background: var(--accent); color:#fff; transition:0.25s; }
button:hover { background:#ff357f; transform:scale(1.05); }
.dark-mode { background:#222; color:#fff; }
.dark-mode input, .dark-mode select { background:#333; color:#fff; border:1px solid #555; }
.card { background: var(--card); border-radius:12px; padding:16px; box-shadow:0 4px 12px var(--shadow); margin-bottom:12px; display:flex; justify-content:space-between; align-items:center; transition:0.3s; }
.card:hover { transform: translateY(-4px); box-shadow:0 8px 24px var(--shadow); }
.task-info { flex:1; margin-left:16px; }
.task-info h3 { margin-bottom:4px; }
.task-info p { font-size:0.9rem; color:#666; }
.completed { text-decoration:line-through; color:#999; }
.category { font-size:0.8rem; padding:2px 6px; border-radius:4px; color:#fff; }
.high { background:#ff5b5b; }
.medium { background:#f5a623; }
.low { background:#4caf50; }
.dragging { opacity:0.5; }
</style>
</head>
<body>
<div class="container">
<h1>Ù„ÛŒØ³Øª Ú©Ø§Ø±Ù‡Ø§ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ ğŸŒŸ</h1>

<div class="controls">
<input type="text" id="taskTitle" placeholder="Ø¹Ù†ÙˆØ§Ù† Ú©Ø§Ø±...">
<select id="taskPriority">
  <option value="high">ğŸ’¥ ÙÙˆØ±ÛŒ</option>
  <option value="medium">âš¡ Ù…ØªÙˆØ³Ø·</option>
  <option value="low">ğŸŒ¿ Ú©Ù…</option>
</select>
<input type="date" id="taskDue">
<button id="addTaskBtn">Ø§ÙØ²ÙˆØ¯Ù† Ú©Ø§Ø±</button>
<button id="toggleDark">ØªØ§Ø±ÛŒÚ©/Ø±ÙˆØ´Ù†</button>
<select id="filterSelect">
  <option value="all">Ù‡Ù…Ù‡</option>
  <option value="high">ğŸ’¥ ÙÙˆØ±ÛŒ</option>
  <option value="medium">âš¡ Ù…ØªÙˆØ³Ø·</option>
  <option value="low">ğŸŒ¿ Ú©Ù…</option>
</select>
</div>

<div id="taskList"></div>
</div>

<script>
let tasks = JSON.parse(localStorage.getItem('tasks')||'[]');

const taskList = document.getElementById('taskList');
const addTaskBtn = document.getElementById('addTaskBtn');
const toggleDark = document.getElementById('toggleDark');
const filterSelect = document.getElementById('filterSelect');

function saveTasks() {
  localStorage.setItem('tasks', JSON.stringify(tasks));
}

function renderTasks(filter='all') {
  taskList.innerHTML='';
  let filtered = tasks.filter(t=> filter==='all' || t.priority===filter );
  filtered.sort((a,b)=> new Date(a.due)-new Date(b.due));
  filtered.forEach((task,index)=>{
    const card = document.createElement('div');
    card.className='card';
    card.draggable=true;
    card.dataset.index=index;
    const catColor = task.priority==='high'?'high':task.priority==='medium'?'medium':'low';
    card.innerHTML=`
      <div class="task-info">
        <h3 class="${task.completed?'completed':''}">${task.title}</h3>
        <p>ğŸ’  Ø³Ø±Ø±Ø³ÛŒØ¯: ${task.due} | <span class="category ${catColor}">${task.priority}</span></p>
      </div>
      <div>
        <button onclick="toggleComplete(${index})">âœ”ï¸</button>
        <button onclick="deleteTask(${index})">ğŸ—‘ï¸</button>
      </div>
    `;
    card.addEventListener('dragstart',dragStart);
    card.addEventListener('dragover',dragOver);
    card.addEventListener('drop',drop);
    card.addEventListener('dragend',dragEnd);
    taskList.appendChild(card);
  });
}

function addTask() {
  const title = document.getElementById('taskTitle').value.trim();
  const priority = document.getElementById('taskPriority').value;
  const due = document.getElementById('taskDue').value;
  if(!title||!due) return alert('Ø¹Ù†ÙˆØ§Ù† Ùˆ Ø³Ø±Ø±Ø³ÛŒØ¯ Ù„Ø§Ø²Ù… Ø§Ø³Øª!');
  tasks.push({title,priority,due,completed:false});
  saveTasks();
  renderTasks(filterSelect.value);
  document.getElementById('taskTitle').value='';
  document.getElementById('taskDue').value='';
}

function deleteTask(index){
  tasks.splice(index,1);
  saveTasks();
  renderTasks(filterSelect.value);
}

function toggleComplete(index){
  tasks[index].completed = !tasks[index].completed;
  saveTasks();
  renderTasks(filterSelect.value);
}

// Dark mode
toggleDark.addEventListener('click',()=>{
  document.body.classList.toggle('dark-mode');
});

// Filter
filterSelect.addEventListener('change',()=>{
  renderTasks(filterSelect.value);
});

addTaskBtn.addEventListener('click',addTask);

// Drag & Drop
let draggedIndex=null;
function dragStart(e){ draggedIndex = e.currentTarget.dataset.index; e.currentTarget.classList.add('dragging'); }
function dragOver(e){ e.preventDefault(); }
function drop(e){
  const dropIndex = e.currentTarget.dataset.index;
  [tasks[draggedIndex], tasks[dropIndex]] = [tasks[dropIndex], tasks[draggedIndex]];
  saveTasks();
  renderTasks(filterSelect.value);
}
function dragEnd(e){ e.currentTarget.classList.remove('dragging'); }

// Initial render
renderTasks();
</script>
</body>
</html>