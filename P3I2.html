<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¨Ø§Ø²ÛŒ Ø­Ø§ÙØ¸Ù‡ Ø´Ø¨Ø§Ù†Ù‡ Ùˆ Ø±ÙˆØ²Ø§Ù†Ù‡</title>
<style>
body { font-family: 'Tahoma', sans-serif; margin:0; padding:0; overflow-y:auto; transition: background 0.5s; }
body.night { background: radial-gradient(circle at center, #0d1b2a, #000); color: #fff; }
body.day { background: radial-gradient(circle at center, #e0f7fa, #b2ebf2); color: #000; }
h1 { text-align:center; padding:20px; transition: color 0.5s, text-shadow 0.5s; }
body.night h1 { color:#e0eaff; text-shadow:0 0 10px #9fc3ff,0 0 20px #6daaff; }
body.day h1 { color:#01579b; text-shadow:0 0 5px #4fc3f7,0 0 10px #81d4fa; }

.game-info { text-align:center; margin-bottom:15px; font-size:1.1rem; }
.game-board { display:grid; grid-template-columns: repeat(4, 1fr); gap:15px; max-width:600px; margin:20px auto; padding:10px; }
.card { width:100%; aspect-ratio:1 / 1; background:#1b263b; border-radius:12px; display:flex; justify-content:center; align-items:center; font-size:2rem; color:transparent; cursor:pointer; transform:scale(1); transition: transform 0.3s ease, background 0.3s ease, color 0.3s ease; box-shadow:0 0 10px rgba(150,200,255,0.2); background-size: cover; background-position: center; }
body.day .card { background:#b2ebf2; }
.card.flipped, .card.matched { transform: rotateY(180deg); color:#fff; }
.card.matched { animation: glow 1s ease infinite alternate; }
@keyframes glow { from{box-shadow:0 0 10px #0ff,0 0 15px #ff6f61 inset;}to{box-shadow:0 0 25px #0ff,0 0 35px #ff6f61 inset;} }

.controls { text-align:center; margin:20px 0; }
.controls button { background:#0d1b2a; color:#e0eaff; border:2px solid #1e3a5f; border-radius:12px; padding:12px 24px; font-size:1rem; margin:5px; cursor:pointer; box-shadow:0 0 10px rgba(150,200,255,0.5); transition: all 0.3s ease; }
body.day .controls button { background:#b2ebf2; color:#01579b; border:2px solid #4dd0e1; box-shadow:0 0 10px rgba(0,150,136,0.5);}
.controls button:hover { transform: scale(1.05); }

#records { text-align:center; margin:20px; font-size:1rem; }
.stars { position:fixed; top:0; left:0; width:100%; height:100%; background:transparent; overflow:hidden; z-index:-1; }
.star { position:absolute; width:2px; height:2px; background:white; border-radius:50%; animation:twinkle 2s infinite alternate; }
@keyframes twinkle { from{opacity:0.2;} to{opacity:1;} }

.theme-toggle { position:fixed; top:10px; left:10px; z-index:1000; padding:10px 20px; border-radius:12px; cursor:pointer; font-weight:bold; }
body.day .theme-toggle { background:#81d4fa; color:#01579b; border:2px solid #4fc3f7;}
body.night .theme-toggle { background:#0d1b2a; color:#e0eaff; border:2px solid #1e3a5f;}
</style>
</head>
<body class="night">
<button class="theme-toggle" onclick="toggleTheme()">Ø±ÙˆØ²</button>
<h1>Ø¨Ø§Ø²ÛŒ Ø­Ø§ÙØ¸Ù‡ Ø´Ø¨Ø§Ù†Ù‡ Ùˆ Ø±ÙˆØ²Ø§Ù†Ù‡ ğŸŒ™âœ¨</h1>
<div class="game-info">
  <span id="time">â±ï¸ Ø²Ù…Ø§Ù†: 0 Ø«Ø§Ù†ÛŒÙ‡</span> | 
  <span id="moves">ğŸ”„ Ø­Ø±Ú©Ø§Øª: 0</span>
</div>
<div class="game-board" id="gameBoard"></div>
<div class="controls">
  <button onclick="startGame()">Ø´Ø±ÙˆØ¹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ğŸ”„</button>
  <button onclick="cancelGame()">Ø§Ù†ØµØ±Ø§Ù âŒ</button>
  <button onclick="showAllCards()">Ù†Ù…Ø§ÛŒØ´ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ ğŸ‘€</button>
</div>
<div id="records">
  <h3>ğŸ† Ø±Ú©ÙˆØ±Ø¯Ù‡Ø§:</h3>
  <ul id="recordList"></ul>
</div>
<div class="stars"></div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script>
const cardsImages=["1.png","2.png","3.png","4.png","5.png","6.png","7.png","8.png"];
let cards=[],flippedCards=[],matchedCount=0,moves=0,time=0,timer;
const board=document.getElementById("gameBoard");
const timeSpan=document.getElementById("time");
const movesSpan=document.getElementById("moves");
const recordList=document.getElementById("recordList");

// ØµØ¯Ø§Ù‡Ø§
const sounds = {
  flip: new Audio('flip.mp3'),
  match: new Audio('match.mp3'),
  wrong: new Audio('wrong.mp3'),
  win: new Audio('win.mp3')
};

function startGame(){
  clearInterval(timer); time=0; moves=0; matchedCount=0; flippedCards=[];
  timeSpan.textContent="â±ï¸ Ø²Ù…Ø§Ù†: 0 Ø«Ø§Ù†ÛŒÙ‡"; movesSpan.textContent="ğŸ”„ Ø­Ø±Ú©Ø§Øª: 0"; board.innerHTML="";
  document.querySelector('.controls button:last-child').disabled=false; // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡ Ù†Ù…Ø§ÛŒØ´ Ú©Ø§Ø±Øª
  let tempCards=[...cardsImages,...cardsImages].sort(()=>Math.random()-0.5);
  cards=tempCards.map((img,index)=>{
    const card=document.createElement("div");
    card.classList.add("card");
    card.dataset.value=img;
    card.dataset.index=index;
    card.style.backgroundImage="url('back.png')";
    card.addEventListener("click",flipCard);
    board.appendChild(card);
    return card;
  });
  timer=setInterval(()=>{time++; timeSpan.textContent=`â±ï¸ Ø²Ù…Ø§Ù†: ${time} Ø«Ø§Ù†ÛŒÙ‡`;},1000);
}

function flipCard(){
  if(flippedCards.length===2 || this.classList.contains("flipped")) return;
  this.classList.add("flipped");
  this.style.backgroundImage=`url('${this.dataset.value}')`;
  flippedCards.push(this);
  sounds.flip.play();
  if(flippedCards.length===2){ moves++; movesSpan.textContent=`ğŸ”„ Ø­Ø±Ú©Ø§Øª: ${moves}`; setTimeout(checkMatch,500);}
}

function checkMatch(){
  const [card1,card2]=flippedCards;
  if(card1.dataset.value===card2.dataset.value){
    card1.classList.add("matched"); card2.classList.add("matched"); matchedCount++;
    sounds.match.play(); playConfetti(card1,card2);
    if(matchedCount===cardsImages.length){ clearInterval(timer); sounds.win.play(); alert(`ğŸ‰ ØªØ¨Ø±ÛŒÚ©! Ø¯Ø± ${time} Ø«Ø§Ù†ÛŒÙ‡ Ùˆ ${moves} Ø­Ø±Ú©Øª Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯ÛŒ!`); saveRecord(time,moves);}
  }else{
    setTimeout(()=>{
      card1.classList.remove("flipped"); card2.classList.remove("flipped");
      card1.style.backgroundImage="url('back.png')";
      card2.style.backgroundImage="url('back.png')";
    }, 800);
    sounds.wrong.play();
  }
  flippedCards=[];
}

function cancelGame(){ clearInterval(timer); alert("âŒ Ø¨Ø§Ø²ÛŒ Ù„ØºÙˆ Ø´Ø¯!"); board.innerHTML=""; }

function saveRecord(time,moves){ const li=document.createElement("li"); li.textContent=`â±ï¸ ${time} Ø«Ø§Ù†ÛŒÙ‡ | ğŸ”„ ${moves} Ø­Ø±Ú©Øª`; recordList.appendChild(li); }

function playConfetti(card1,card2){
  const rect1=card1.getBoundingClientRect(), rect2=card2.getBoundingClientRect();
  confetti({particleCount:100,spread:160,origin:{x:(rect1.left+rect1.width/2)/window.innerWidth,y:(rect1.top+rect1.height/2)/window.innerHeight},colors:['#ff6f61','#ffecd2','#ff3b2f','#0ff','#f0f']});
  confetti({particleCount:100,spread:160,origin:{x:(rect2.left+rect2.width/2)/window.innerWidth,y:(rect2.top+rect2.height/2)/window.innerHeight},colors:['#ff6f61','#ffecd2','#ff3b2f','#0ff','#f0f']});
}

function createStars(){ const starsContainer=document.querySelector('.stars'); for(let i=0;i<100;i++){ const star=document.createElement('div'); star.classList.add('star'); star.style.top=`${Math.random()*100}%`; star.style.left=`${Math.random()*100}%`; star.style.animationDuration=`${Math.random()*3+2}s`; starsContainer.appendChild(star);} }

function toggleTheme(){ const body=document.body; if(body.classList.contains("night")){ body.classList.replace("night","day"); document.querySelector(".theme-toggle").textContent="Ø´Ø¨"; }else{ body.classList.replace("day","night"); document.querySelector(".theme-toggle").textContent="Ø±ÙˆØ²"; }}

function showAllCards(){
  const showButton=document.querySelector('.controls button:last-child');
  showButton.disabled=true;
  cards.forEach(card=>card.style.backgroundImage=`url('${card.dataset.value}')`);
  setTimeout(()=>{ cards.forEach(card=>{ if(!card.classList.contains('flipped') && !card.classList.contains('matched')) card.style.backgroundImage="url('back.png')"; }); },2000);
}

createStars(); startGame();
</script>
</body>
</html>